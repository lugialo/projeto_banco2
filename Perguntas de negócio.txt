Exemplifique qual a especialidade de dentistas que teve mais agendamentos nos últimos 4 meses juntamente com o procedimento que mais foi realizado pelos especialistas.


1.Determinar a Especialidade com Mais Agendamentos nos Últimos 4 Meses
SELECT 
    o.especialidade, 
    COUNT(a.id_agendamento) AS total_agendamentos
FROM 
    agendamento a
JOIN 
    odontologista o ON a.odontologista_id_odontologista = o.id_odontologista
WHERE 
    a.data_agendamento >= DATE_SUB(CURDATE(), INTERVAL 4 MONTH)
GROUP BY 
    o.especialidade
ORDER BY 
    total_agendamentos DESC
LIMIT 1;



2.Determinar o Procedimento Mais Realizado por Especialistas da Especialidade Mais Agendada
SELECT 
    p.nome_procedimento, 
    COUNT(cp.consulta_id_procedimento) AS total_procedimentos
FROM 
    consulta_procedimento cp
JOIN 
    consulta c ON cp.consulta_id_consulta = c.id_consulta
JOIN 
    agendamento a ON c.agendamento_id_agendamento = a.id_agendamento
JOIN 
    odontologista o ON a.odontologista_id_odontologista = o.id_odontologista
JOIN 
    procedimento p ON cp.consulta_id_procedimento = p.id_procedimento
WHERE 
    o.especialidade = (
        SELECT 
            o.especialidade
        FROM 
            agendamento a
        JOIN 
            odontologista o ON a.odontologista_id_odontologista = o.id_odontologista
        WHERE 
            a.data_agendamento >= DATE_SUB(CURDATE(), INTERVAL 4 MONTH)
        GROUP BY 
            o.especialidade
        ORDER BY 
            COUNT(a.id_agendamento) DESC
        LIMIT 1
    )
GROUP BY 
    p.nome_procedimento
ORDER BY 
    total_procedimentos DESC
LIMIT 1;

========================================================================================================================================================================================

Qual o diagnóstico que teve maior incidência em pacientes com idades inferiores a 16 anos em ambos os gêneros durante os primeiros 6 meses do ano.

1.Selecionar pacientes com idade inferior a 16 anos:

SELECT id_paciente, nome_paciente, data_nasc 
FROM paciente 
WHERE TIMESTAMPDIFF(YEAR, data_nasc, CURDATE()) < 16;



2.Selecionar as consultas desses pacientes nos primeiros seis meses do ano:

SELECT c.diagnostico, COUNT(*) as incidencia 
FROM consulta c
JOIN agendamento a ON c.agendamento_id_agendamento = a.id_agendamento
JOIN paciente p ON a.paciente_id_paciente = p.id_paciente
WHERE TIMESTAMPDIFF(YEAR, p.data_nasc, CURDATE()) < 16
AND c.data_hora BETWEEN '2024-01-01' AND '2024-06-30'
GROUP BY c.diagnostico
ORDER BY incidencia DESC
LIMIT 1;
========================================================================================================================================================================================
Qual é a média de idade dos pacientes que realizaram procedimentos de restauração dentária nos últimos três meses, agrupados por faixas etárias, para os pacientes do sexo feminino?

Qual é o meio de pagamento mais utliziado, nos ultimos 6 meses, entre pacientes do sexo feminino na faixa etária de 18 a 55 anos, em ordem decrescente?
